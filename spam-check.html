
<!DOCTYPE html>
<html lang="ml">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>üîê ‡¥ï‡¥æ‡¥µ‡µΩ++ ‚Äì ‡¥≤‡¥ø‡¥ô‡µç‡¥ï‡µç ‡¥∏‡µÅ‡¥∞‡¥ï‡µç‡¥∑‡¥æ ‡¥™‡¥∞‡¥ø‡¥∂‡µã‡¥ß‡¥®</title>
  <link rel="manifest" href="manifest.json">
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Malayalam&display=swap" rel="stylesheet" />
  <style>
body {
  background: #0f172a;
  color: #f1f5f9;
  font-family: 'Noto Sans Malayalam', 'Segoe UI', sans-serif;
  padding: 20px;
  text-align: center;
}

h1 {
  color: #00ffae;
  font-size: 2rem;
  margin-bottom: 10px;
}

.input-container {
  display: flex;
  flex-direction: column;
  align-items: center;
  margin-bottom: 10px;
}

input,
button {
  padding: 12px;
  margin: 10px;
  font-size: 1rem;
  border: none;
  border-radius: 8px;
  width: 80%;
  max-width: 500px;
  transition: all 0.3s ease;
}

input {
  background: #334155;
  color: #f8fafc;
}
input:focus {
  outline: 2px solid #00ffae;
}

button {
  background: #00ffae;
  color: #0f172a;
  cursor: pointer;
}
button:hover {
  background: #5effc3;
}

#report {
  text-align: left;
  background: #1e293b;
  padding: 20px;
  border-radius: 10px;
  margin-top: 20px;
  max-width: 700px;
  margin-left: auto;
  margin-right: auto;
}

.safe {
  color: #00ff7f;
}
.danger {
  color: #ff4f4f;
}
.warn {
  color: #ffdf00;
}

pre {
  white-space: pre-wrap;
  word-wrap: break-word;
}

img {
  max-width: 100%;
  border-radius: 6px;
  margin-top: 10px;
}

#loader {
  color: #ffdf00;
  font-weight: bold;
  margin-top: 15px;
}

  </style>
</head>

<body>
  <h1>üåê ‡¥ï‡¥æ‡¥µ‡µΩ++</h1>
  <p>‡¥™‡¥∞‡¥ø‡¥∂‡µã‡¥ß‡¥ø‡¥ï‡µç‡¥ï‡µá‡¥£‡µç‡¥ü ‡¥≤‡¥ø‡¥ô‡µç‡¥ï‡µç ‡¥®‡µΩ‡¥ï‡µÇ:</p>

  <div class="input-container">
    <input id="urlInput" placeholder="‡¥â‡¥¶‡¥æ‡¥π‡¥∞‡¥£‡¥Ç: https://bit.ly/xyz" aria-label="‡¥™‡¥∞‡¥ø‡¥∂‡µã‡¥ß‡¥ø‡¥ï‡µç‡¥ï‡µá‡¥£‡µç‡¥ü URL" />
    <button id="checkBtn">‡¥™‡¥∞‡¥ø‡¥∂‡µã‡¥ß‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥ï</button>
  </div>

  <div id="loader" hidden>‚è≥ ‡¥™‡¥∞‡¥ø‡¥∂‡µã‡¥ß‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥®‡µç‡¥®‡µÅ...</div>
  <div id="report"></div>

<script>

document.getElementById('checkBtn').addEventListener('click', checkURL);

async function checkURL() {
  const urlField = document.getElementById('urlInput');
  const report = document.getElementById('report');
  const loader = document.getElementById('loader');
  const url = urlField.value.trim();

  report.innerHTML = '';
  loader.hidden = false;

  if (!isValidURL(url)) {
    showError("‚ö†Ô∏è ‡¥¶‡¥Ø‡¥µ‡¥æ‡¥Ø‡¥ø ‡¥∏‡¥æ‡¥ß‡µÅ‡¥µ‡¥æ‡¥Ø https:// ‡¥≤‡¥ø‡¥ô‡µç‡¥ï‡µç ‡¥®‡µΩ‡¥ï‡µÇ.", "warn", report, loader);
    return;
  }

  const domain = new URL(url).hostname;
  appendLine(report, `<p>üåê URL: <code>${url}</code></p>`);

  try {
    await Promise.allSettled([
      checkSSL(domain, report),
      checkWHOIS(domain, report),
      checkHeaders(url, report),
      checkPhishTank(url, report),
      checkSpamhaus(domain, report),
      unshorten(url, report),
      aiHeuristic(url, report),
      showScreenshot(url, report)  // Added thum.io screenshot preview
    ]);
  } catch (e) {
    appendLine(report, `<p class="warn">‚ö†Ô∏è ‡¥ö‡¥ø‡¥≤ ‡¥™‡¥∞‡¥ø‡¥∂‡µã‡¥ß‡¥®‡¥ï‡µæ ‡¥™‡¥∞‡¥æ‡¥ú‡¥Ø‡¥™‡µç‡¥™‡µÜ‡¥ü‡µç‡¥ü‡µÅ: ${e.message}</p>`);
  }

  finalVerdict(url, report);
  loader.hidden = true;
}

// -------------------- Helper Functions -------------------- //

function isValidURL(u) {
  try {
    const parsed = new URL(u);
    return parsed.protocol === "https:" || parsed.protocol === "http:";
  } catch {
    return false;
  }
}

async function checkSSL(domain, report) {
  appendLine(report, `<p>üîí SSL ‡¥™‡¥∞‡¥ø‡¥∂‡µã‡¥ß‡¥®...</p>`);
  try {
    await fetch(`https://${domain}`, { method: "HEAD", mode: "no-cors" });
    appendLine(report, `<p>SSL: <span class="safe">‡¥â‡¥£‡µç‡¥ü‡µç</span></p>`);
  } catch {
    appendLine(report, `<p>SSL: <span class="danger">‡¥á‡¥≤‡µç‡¥≤ ‡¥Ö‡¥≤‡µç‡¥≤‡µÜ‡¥ô‡µç‡¥ï‡¥ø‡µΩ ‡¥™‡µç‡¥∞‡¥§‡¥ø‡¥ï‡¥∞‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥®‡µç‡¥®‡¥ø‡¥≤‡µç‡¥≤</span></p>`);
  }
}

async function checkWHOIS(domain, report) {
  appendLine(report, `<p>üåç WHOIS ‡¥™‡¥∞‡¥ø‡¥∂‡µã‡¥ß‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥®‡µç‡¥®‡µÅ...</p>`);
  try {
    const res = await fetch(`https://api.whois.vu/?q=${domain}`);
    const text = await res.text();
    const found = text.includes("Domain Name");
    appendLine(report, `<p>WHOIS: ${found ? '<span class="safe">‡¥ï‡¥£‡µç‡¥ü‡µÜ‡¥§‡µç‡¥§‡¥ø</span>' : '<span class="warn">‡¥ï‡¥£‡µç‡¥ü‡µÜ‡¥§‡µç‡¥§‡¥ø‡¥Ø‡¥ø‡¥≤‡µç‡¥≤</span>'}</p>`);
  } catch {
    appendLine(report, `<p class="warn">‚ö†Ô∏è WHOIS API ‡¥≤‡¥≠‡¥ø‡¥ö‡µç‡¥ö‡¥ø‡¥≤‡µç‡¥≤.</p>`);
  }
}

async function checkHeaders(url, report) {
  appendLine(report, `<p>üîå Header ‡¥™‡¥∞‡¥ø‡¥∂‡µã‡¥ß‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥®‡µç‡¥®‡µÅ...</p>`);
  try {
    const res = await fetch(url, { method: "HEAD" });
    appendLine(report, `<p>Header: <span class="safe">${res.status} ${res.statusText}</span></p>`);
  } catch (e) {
    appendLine(report, `<p class="warn">‚ö†Ô∏è Header ‡¥≤‡¥≠‡¥ø‡¥ö‡µç‡¥ö‡¥ø‡¥≤‡µç‡¥≤: ${e.message}</p>`);
  }
}

async function checkPhishTank(url, report) {
  appendLine(report, `<p>üé£ ‡¥´‡¥ø‡¥∑‡¥ø‡¥Ç‡¥ó‡µç ‡¥™‡¥∞‡¥ø‡¥∂‡µã‡¥ß‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥®‡µç‡¥®‡µÅ...</p>`);
  try {
    const res = await fetch(`https://checkurl.phishtank.com/checkurl/?url=${encodeURIComponent(url)}&format=json`);
    const data = await res.json();
    const phish = data.results?.in_database && data.results?.valid;
    appendLine(report, `PhishTank: ${phish ? '<span class="danger">‚ö†Ô∏è ‡¥´‡¥ø‡¥∑‡¥ø‡¥Ç‡¥ó‡µç ‡¥∏‡¥æ‡¥ß‡µç‡¥Ø‡¥§</span>' : '<span class="safe">‡¥∏‡µÅ‡¥∞‡¥ï‡µç‡¥∑‡¥ø‡¥§‡¥Ç</span>'}`);
  } catch {
    appendLine(report, `<p class="warn">‚ö†Ô∏è ‡¥´‡¥ø‡¥∑‡¥ø‡¥Ç‡¥ó‡µç ‡¥°‡¥æ‡¥±‡µç‡¥± ‡¥≤‡¥≠‡¥ø‡¥ö‡µç‡¥ö‡¥ø‡¥≤‡µç‡¥≤.</p>`);
  }
}

async function checkSpamhaus(domain, report) {
  appendLine(report, `<p>üö´ Spamhaus DBL ‡¥™‡¥∞‡¥ø‡¥∂‡µã‡¥ß‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥®‡µç‡¥®‡µÅ...</p>`);
  try {
    const res = await fetch(`https://dns.google/resolve?name=${domain}.dbl.spamhaus.org&type=A`);
    const data = await res.json();
    appendLine(report, `Spamhaus: ${data.Answer ? '<span class="danger">‡¥¨‡µç‡¥≤‡¥æ‡¥ï‡µç‡¥ï‡µç‚Äå‡¥≤‡¥ø‡¥∏‡µç‡¥±‡µç‡¥±‡¥ø‡µΩ ‡¥â‡¥£‡µç‡¥ü‡µç</span>' : '<span class="safe">‡¥¨‡µç‡¥≤‡¥æ‡¥ï‡µç‡¥ï‡µç‚Äå‡¥≤‡¥ø‡¥∏‡µç‡¥±‡µç‡¥±‡¥ø‡µΩ ‡¥á‡¥≤‡µç‡¥≤</span>'}`);
  } catch {
    appendLine(report, `<p class="warn">‚ö†Ô∏è Spamhaus ‡¥ï‡¥£‡¥ï‡µç‡¥∑‡µª ‡¥™‡¥∞‡¥æ‡¥ú‡¥Ø‡¥Ç.</p>`);
  }
}

async function unshorten(url, report) {
  appendLine(report, `<p>üîó ‡¥≤‡¥ø‡¥ô‡µç‡¥ï‡µç Unshort ‡¥ö‡µÜ‡¥Ø‡µç‡¥Ø‡µÅ‡¥®‡µç‡¥®‡µÅ...</p>`);
  try {
    const res = await fetch(url, { redirect: "follow" });
    appendLine(report, `<p>‡¥Ö‡¥µ‡¥∏‡¥æ‡¥® URL: <code>${res.url}</code></p>`);
  } catch {
    appendLine(report, `<p class="warn">‚ö†Ô∏è Unshort ‡¥ö‡µÜ‡¥Ø‡µç‡¥Ø‡¥æ‡¥®‡¥æ‡¥Ø‡¥ø‡¥≤‡µç‡¥≤.</p>`);
  }
}

function aiHeuristic(url, report) {
  appendLine(report, `<p>üß† AI heuristic ‡¥™‡¥∞‡¥ø‡¥∂‡µã‡¥ß‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥®‡µç‡¥®‡µÅ...</p>`);
  return new Promise(resolve => {
    setTimeout(() => {
      const hints = [];
      if (/bit\.ly|tinyurl/.test(url)) hints.push("‚ö†Ô∏è ‡¥ö‡µÅ‡¥∞‡µÅ‡¥ï‡µç‡¥ï‡¥ø‡¥Ø ‡¥≤‡¥ø‡¥ô‡µç‡¥ï‡µç");
      if (/login|signin/.test(url)) hints.push("‚ö†Ô∏è 'Login' ‡¥™‡¥¶‡¥Ç ‚Äì ‡¥´‡¥ø‡¥∑‡¥ø‡¥Ç‡¥ó‡µç ‡¥∏‡¥æ‡¥ß‡µç‡¥Ø‡¥§");
      if (/\.(exe|apk)$/.test(url)) hints.push("üö´ ‡¥Ö‡¥™‡¥ï‡¥ü‡¥ï‡¥∞‡¥Æ‡¥æ‡¥Ø ‡¥´‡¥Ø‡µΩ ‡¥´‡µã‡µº‡¥Æ‡¥æ‡¥±‡µç‡¥±‡µç");
      if (!hints.length) hints.push("‚úÖ ‡¥®‡¥ø‡¥Ø‡¥®‡µç‡¥§‡µç‡¥∞‡¥ø‡¥§‡¥Æ‡¥æ‡¥Ø ‡¥Ö‡¥ü‡¥Ø‡¥æ‡¥≥‡¥ô‡µç‡¥ô‡µæ ‡¥á‡¥≤‡µç‡¥≤.");
      appendLine(report, `<pre>${hints.join("\n")}</pre>`);
      resolve();
    }, 400);
  });
}

function finalVerdict(url, report) {
  const score = [
    !url.startsWith("https"),
    /bit\.ly/.test(url),
    /login/.test(url),
    /\.(exe|apk)$/.test(url)
  ].filter(Boolean).length;

  if (score >= 2)
    appendLine(report, `<p class="danger">üî¥ ‡¥Ö‡¥™‡¥ï‡¥ü‡¥ï‡¥∞‡¥Ç ‚Äì ‡¥à ‡¥≤‡¥ø‡¥ô‡µç‡¥ï‡µç ‡¥§‡µÅ‡¥±‡¥ï‡µç‡¥ï‡¥∞‡µÅ‡¥§‡µç!</p>`);
  else if (score === 1)
    appendLine(report, `<p class="warn">üü° ‡¥∏‡¥Ç‡¥∂‡¥Ø‡¥ï‡¥∞‡¥Ç ‚Äì ‡¥ú‡¥æ‡¥ó‡µç‡¥∞‡¥§ ‡¥Ü‡¥µ‡¥∂‡µç‡¥Ø‡¥Æ‡¥æ‡¥£‡µç.</p>`);
  else
    appendLine(report, `<p class="safe">üü¢ ‡¥∏‡µÅ‡¥∞‡¥ï‡µç‡¥∑‡¥ø‡¥§‡¥Æ‡¥æ‡¥Ø‡¥ø ‡¥§‡µã‡¥®‡µç‡¥®‡µÅ‡¥®‡µç‡¥®‡µÅ.</p>`);
}

function appendLine(el, html) {
  el.innerHTML += html;
}

function showError(msg, cls, report, loader) {
  report.innerHTML = `<p class="${cls}">${msg}</p>`;
  loader.hidden = true;
}

// New function to add thum.io screenshot preview
async function showScreenshot(url, report) {
  appendLine(report, `<p>üñºÔ∏è ‡¥∏‡µà‡¥±‡µç‡¥±‡¥ø‡¥®‡µç‡¥±‡µÜ ‡¥∏‡µç‡¥ï‡µç‡¥∞‡µÄ‡µª‡¥∑‡µã‡¥ü‡µç‡¥ü‡µç ‡¥ï‡¥æ‡¥£‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥®‡µç‡¥®‡µÅ...</p>`);
  const encodedUrl = encodeURIComponent(url);
  const imgSrc = `https://image.thum.io/get/width/600/crop/600/${url}`;
  appendLine(report, `<a href="${imgSrc}"> <button> view websites sample look </button></a>`);
}

</script>
</body>
</html>
