<!DOCTYPE html>
<html lang="ml">
<head>
  <meta charset="UTF-8">
  <title>üîê ‡¥ï‡¥æ‡¥µ‡µΩ ‚Äì ‡¥∏‡µà‡¥¨‡µº ‡¥≤‡¥ø‡¥ô‡µç‡¥ï‡µç ‡¥∏‡¥Ç‡¥∞‡¥ï‡µç‡¥∑‡¥ï‡µª</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="manifest" href="manifest.json">
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Malayalam&display=swap" rel="stylesheet">
  <style>
    body {
      background:#0f172a;
      color:#f1f5f9;
      font-family:'Noto Sans Malayalam', 'Segoe UI', sans-serif;
      padding:20px;
      text-align:center;
    }
    h1 { color:#00ffae; font-size:2rem; }
    input, button {
      padding:12px;
      margin:10px;
      font-size:1rem;
      border:none;
      border-radius:8px;
      width:80%;
      max-width:500px;
    }
    input { background:#334155; color:#f8fafc; }
    button {
      background:#00ffae;
      color:#0f172a;
      cursor:pointer;
    }
    #report {
      text-align:left;
      background:#1e293b;
      padding:20px;
      border-radius:10px;
      margin-top:20px;
    }
    .safe { color:#00ff7f; }
    .danger { color:#ff4f4f; }
    .warn { color:#ffdf00; }
    img { max-width:100%; border-radius:6px; margin-top:10px; }
    pre { white-space:pre-wrap; word-wrap:break-word; }
  </style>
</head>
<body>
  <h1>üåê ‡¥ï‡¥æ‡¥µ‡µΩ++</h1>
  <p>‡¥ö‡µã‡¥¶‡µç‡¥Ø‡¥Ç ‡¥ö‡µÜ‡¥Ø‡µç‡¥Ø‡µá‡¥£‡µç‡¥ü ‡¥≤‡¥ø‡¥ô‡µç‡¥ï‡µç ‡¥®‡µΩ‡¥ï‡µÇ:</p>
  <input id="urlInput" placeholder="‡¥â‡¥¶‡¥æ‡¥π‡¥∞‡¥£‡¥Ç: https://bit.ly/xyz">
  <button onclick="checkURL()">‡¥™‡¥∞‡¥ø‡¥∂‡µã‡¥ß‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥ï</button>
  <div id="report"></div>

  <script>
    async function checkURL() {
      const url = document.getElementById('urlInput').value.trim();
      const output = document.getElementById('report');
      output.innerHTML = "";

      if (!url.startsWith("http")) {
        output.innerHTML = "<p class='warn'>‚ö†Ô∏è ‡¥¶‡¥Ø‡¥µ‡¥æ‡¥Ø‡¥ø ‡¥™‡µÇ‡µº‡¥£‡µç‡¥£‡¥Æ‡¥æ‡¥Ø https:// ‡¥≤‡¥ø‡¥ô‡µç‡¥ï‡µç ‡¥®‡µΩ‡¥ï‡µÇ.</p>";
        return;
      }

      const domain = (new URL(url)).hostname;
      let result = [];

      output.innerHTML += `<p>üåê URL: <code>${url}</code></p>`;

      // ‚úÖ Real SSL Check using HEAD request to https://domain
      output.innerHTML += `<p>üîí SSL ‡¥∏‡¥™‡µç‡¥™‡µã‡µº‡¥ü‡µç‡¥ü‡µç: <span id="sslStatus">‡¥™‡¥∞‡¥ø‡¥∂‡µã‡¥ß‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥®‡µç‡¥®‡µÅ...</span></p>`;
      try {
        const testSSL = await fetch("https://" + domain, { method: "HEAD" });
        if (testSSL.ok) {
          document.getElementById("sslStatus").innerHTML = '<span class="safe">‡¥â‡¥£‡µç‡¥ü‡µç</span>';
        } else {
          document.getElementById("sslStatus").innerHTML = '<span class="warn">‡¥∏‡µÜ‡µº‡¥µ‡µº ‡¥™‡µç‡¥∞‡¥§‡¥ø‡¥ï‡¥∞‡¥ø‡¥ö‡µç‡¥ö‡¥ø‡¥≤‡µç‡¥≤</span>';
        }
      } catch {
        document.getElementById("sslStatus").innerHTML = '<span class="danger">‡¥á‡¥≤‡µç‡¥≤</span>';
      }

      // WHOIS
      output.innerHTML += `<p>üåç WHOIS ‡¥™‡¥∞‡¥ø‡¥∂‡µã‡¥ß‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥®‡µç‡¥®‡µÅ...</p>`;
      try {
        const res = await fetch(`https://api.whois.vu/?q=${domain}`);
        const text = await res.text();
        output.innerHTML += `<p>WHOIS ‡¥´‡¥≤‡¥ô‡µç‡¥ô‡µæ: ${text.includes("Domain Name") ? '<span class="safe">‡¥ï‡¥£‡µç‡¥ü‡µÜ‡¥§‡µç‡¥§‡¥ø‡¥Ø‡¥ø‡¥ü‡µç‡¥ü‡µÅ‡¥£‡µç‡¥ü‡µç</span>' : '<span class="warn">‡¥ï‡¥£‡µç‡¥ü‡µÜ‡¥§‡µç‡¥§‡¥ø‡¥Ø‡¥ø‡¥≤‡µç‡¥≤</span>'}</p>`;
      } catch {
        output.innerHTML += `<p class="warn">‚ö†Ô∏è WHOIS ‡¥ï‡¥£‡¥ï‡µç‡¥ï‡µÅ‡¥ï‡µæ ‡¥≤‡¥≠‡¥ø‡¥ö‡µç‡¥ö‡¥ø‡¥≤‡µç‡¥≤.</p>`;
      }

      // Header Status
      output.innerHTML += `<p>üîå ‡¥π‡µÜ‡¥°‡µº ‡¥™‡¥∞‡¥ø‡¥∂‡µã‡¥ß‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥®‡µç‡¥®‡µÅ...</p>`;
      try {
        const headRes = await fetch(url, { method: 'HEAD' });
        output.innerHTML += `<p>Header: <span class="safe">‚úÖ ${headRes.status} ${headRes.statusText}</span></p>`;
      } catch (e) {
        output.innerHTML += `<p class="danger">‚ùå ‡¥π‡µÜ‡¥°‡µº ‡¥≤‡¥≠‡¥ø‡¥ö‡µç‡¥ö‡¥ø‡¥≤‡µç‡¥≤: ${e.message}</p>`;
      }

      // Screenshot Preview
      output.innerHTML += `<p>üì∑ ‡¥∏‡µà‡¥±‡µç‡¥±‡¥ø‡¥®‡µç‡¥±‡µÜ ‡¥∞‡µÇ‡¥™‡¥Ç:</p><img src="https://image.thum.io/get/width/600/crop/600/${url}" alt="preview" />`;

      // AI Analysis (Offline Heuristic)
      output.innerHTML += `<p>üß† AI ‡¥µ‡¥ø‡¥∂‡¥ï‡¥≤‡¥®‡¥Ç:</p><pre id="aiResult">‡¥µ‡¥ø‡¥∂‡¥ï‡¥≤‡¥®‡¥Ç ‡¥®‡¥ü‡¥ï‡µç‡¥ï‡µÅ‡¥®‡µç‡¥®‡µÅ...</pre>`;
      setTimeout(() => {
        const hints = [];
        if (url.includes("bit.ly") || url.includes("tinyurl")) hints.push("‚ö†Ô∏è Shortened URL (‡¥ö‡µÅ‡¥∞‡µÅ‡¥ï‡µç‡¥ï‡¥ø‡¥Ø ‡¥≤‡¥ø‡¥ô‡µç‡¥ï‡µç)");
        if (url.includes("login") || url.includes("signin")) hints.push("‚ö†Ô∏è Login keyword ‚Äì ‡¥´‡¥ø‡¥∑‡¥ø‡¥Ç‡¥ó‡µç ‡¥Ü‡¥ï‡¥æ‡¥Æ‡µç");
        if (url.endsWith(".exe") || url.endsWith(".apk")) hints.push("üö´ ‡¥¶‡µã‡¥∑‡¥ï‡¥∞‡¥Æ‡¥æ‡¥Ø ‡¥´‡¥Ø‡µΩ ‡¥´‡µã‡µº‡¥Æ‡¥æ‡¥±‡µç‡¥±‡µç");
        if (hints.length === 0) hints.push("‚úÖ ‡¥®‡¥ø‡¥Ø‡¥®‡µç‡¥§‡µç‡¥∞‡¥ø‡¥§‡¥Æ‡¥æ‡¥Ø ‡¥Ö‡¥ü‡¥Ø‡¥æ‡¥≥‡¥ô‡µç‡¥ô‡µæ ‡¥á‡¥≤‡µç‡¥≤.");
        document.getElementById("aiResult").innerText = hints.join("\n");
      }, 600);

      // PhishTank Check
      output.innerHTML += `<p>üé£ ‡¥´‡¥ø‡¥∑‡¥ø‡¥Ç‡¥ó‡µç ‡¥™‡¥∞‡¥ø‡¥∂‡µã‡¥ß‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥®‡µç‡¥®‡µÅ...</p>`;
      try {
        const res = await fetch(`https://checkurl.phishtank.com/checkurl/?url=${encodeURIComponent(url)}&format=json`);
        const data = await res.json();
        const isPhishing = data.results.valid && data.results.in_database;
        output.innerHTML += `<p>PhishTank: ${isPhishing ? '<span class="danger">‡¥´‡¥ø‡¥∑‡¥ø‡¥Ç‡¥ó‡µç ‡¥∏‡¥æ‡¥ß‡µç‡¥Ø‡¥§</span>' : '<span class="safe">‡¥∏‡µÅ‡¥∞‡¥ï‡µç‡¥∑‡¥ø‡¥§‡¥Ç</span>'}</p>`;
      } catch {
        output.innerHTML += `<p class="warn">‚ö†Ô∏è ‡¥´‡¥ø‡¥∑‡µç ‡¥°‡¥æ‡¥±‡µç‡¥± ‡¥≤‡¥≠‡¥ø‡¥ö‡µç‡¥ö‡¥ø‡¥≤‡µç‡¥≤.</p>`;
      }

      // Spamhaus DBL Check
      output.innerHTML += `<p>üö´ Spamhaus DBL ‡¥™‡¥∞‡¥ø‡¥∂‡µã‡¥ß‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥®‡µç‡¥®‡µÅ...</p>`;
      try {
        const spamRes = await fetch(`https://dns.google/resolve?name=${domain}.dbl.spamhaus.org&type=A`);
        const spamData = await spamRes.json();
        const listed = spamData.Answer !== undefined;
        output.innerHTML += `<p>Spamhaus: ${listed ? '<span class="danger">‡¥¨‡µç‡¥≤‡¥æ‡¥ï‡µç‡¥ï‡µç‚Äå‡¥≤‡¥ø‡¥∏‡µç‡¥±‡µç‡¥±‡¥ø‡µΩ ‡¥â‡¥£‡µç‡¥ü‡µç</span>' : '<span class="safe">‡¥¨‡µç‡¥≤‡¥æ‡¥ï‡µç‡¥ï‡µç‚Äå‡¥≤‡¥ø‡¥∏‡µç‡¥±‡µç‡¥±‡¥ø‡µΩ ‡¥á‡¥≤‡µç‡¥≤</span>'}</p>`;
      } catch {
        output.innerHTML += `<p class="warn">‚ö†Ô∏è Spamhaus ‡¥ï‡¥£‡¥ï‡µç‡¥∑‡µª ‡¥™‡¥∞‡¥æ‡¥ú‡¥Ø‡¥Ç.</p>`;
      }

      // Unshortener
      output.innerHTML += `<p>üîó ‡¥≤‡¥ø‡¥ô‡µç‡¥ï‡µç Unshort ‡¥ö‡µÜ‡¥Ø‡µç‡¥Ø‡µÅ‡¥®‡µç‡¥®‡µÅ...</p>`;
      try {
        const res = await fetch(url, { method: "GET", redirect: "follow" });
        output.innerHTML += `<p>‡¥Ö‡¥µ‡¥∏‡¥æ‡¥® URL: <code>${res.url}</code></p>`;
      } catch {
        output.innerHTML += `<p class="warn">‚ö†Ô∏è URL Unshort ‡¥ö‡µÜ‡¥Ø‡µç‡¥Ø‡¥æ‡¥®‡¥æ‡¥Ø‡¥ø‡¥≤‡µç‡¥≤.</p>`;
      }

      // Final Verdict
      const score = [
        !url.startsWith("https"),
        url.includes("bit.ly"),
        url.includes("login"),
        url.endsWith(".exe") || url.endsWith(".apk")
      ].filter(Boolean).length;

      if (score >= 2) {
        output.innerHTML += `<p class="danger">üî¥ ‡¥Ö‡¥™‡¥ï‡¥ü‡¥ï‡¥∞‡¥Ç ‚Äì ‡¥à ‡¥≤‡¥ø‡¥ô‡µç‡¥ï‡µç ‡¥§‡µÅ‡¥±‡¥ï‡µç‡¥ï‡¥∞‡µÅ‡¥§‡µç!</p>`;
      } else if (score === 1) {
        output.innerHTML += `<p class="warn">üü° ‡¥ï‡µÅ‡¥±‡¥ö‡µç‡¥ö‡µç ‡¥∏‡¥Ç‡¥∂‡¥Ø‡¥Ç ‡¥â‡¥£‡µç‡¥ü‡µç ‚Äì ‡¥ú‡¥æ‡¥ó‡µç‡¥∞‡¥§ ‡¥Ü‡¥µ‡¥∂‡µç‡¥Ø‡¥Æ‡¥æ‡¥£‡µç.</p>`;
      } else {
        output.innerHTML += `<p class="safe">üü¢ ‡¥≤‡¥ø‡¥ô‡µç‡¥ï‡µç ‡¥∏‡µÅ‡¥∞‡¥ï‡µç‡¥∑‡¥ø‡¥§‡¥Ç ‡¥™‡µã‡¥≤‡µÜ ‡¥§‡µã‡¥®‡µç‡¥®‡µÅ‡¥®‡µç‡¥®‡µÅ.</p>`;
      }
    }
  </script>
</body>
</html>
